function abonnement(){var handlers={};return{getRegisterHandler:function(eventName,defaultKey){return defaultKey=defaultKey||"id",function(filter,handler){return handlers[eventName]||(handlers[eventName]=[]),handler||(handler=filter,filter=[]),Array.isArray(filter)||(filter=[filter]),filter=filter.map(function(filterItem){if("string"!=typeof filterItem)return filterItem;var objectFilterItem={};return objectFilterItem[defaultKey]=filterItem,objectFilterItem}),handlers[eventName].push({filter:filter,callback:handler}),this}},trigger:function(eventName,event){handlers[eventName]&&(event||(event={}),handlers[eventName].forEach(function(handler){(function(event,filter){return!filter.length||filter.some(function(filterItem){return Object.keys(filterItem).every(function(key){return filterItem[key]===event[key]})})})(event,handler.filter)&&handler.callback(event)}))}}}